2.操作系统：3-5
进程管理
操作系统概述
操作系统：管理系统的软件和硬件资源。
操作系统的作用：管理软硬件资源，提供友善的人机界面，为应用开发提供高效率的平台。
操作系统4个特征：并发性、共享性、虚拟性、不确定性（异步性）
操作系统功能：5大
进程管理：对CPU的执行时间进行管理，采用多道程序等技术，包括进程控制、进程同步、进程通信和进程调度。
存储管理：对主存储器空间进行管理，包括存储分配与回收、存储保护、地址映射和主存扩充。
设备管理：对硬件设备的管理，包括对输入/输出设备的分配、启动、完成和回收。
文件管理：
作业管理：包括任务、界面管理、人机交互、图形界面、语音控制和虚拟现实等。
操作系统分类：
批处理：单道（一次一个）、多道（一次多个）
分时：将CPU的工作时间划分多个时间片，交替运行（并发）。对交互能力要求高
实时：快速响应，对交互能力要求不高，要求可靠性。
网络：联网计算机能方便有效的共享网络资源，提供各种服务、协议。三种模式：集中模式（集中的计算机来共享），客户端/服务器模式（C/S）、对等模式（P2P各个计算机平等的，即可以当客户端也可以当服务器）
分布式：网络系统的升级，多个计算机分配位置不同。
微型：Windows、MacOS
嵌入式：
特点：微型化（占资源小）、可定制（针对硬件定制）、实时性、可靠性、易移植性。
嵌入式系统初始化过程，按照从底向上、从硬件到软件次序为：片级初始化—>板级初始化—>系统初始化。
进程组成和状态
进程的组成：进程控制块PCB（唯一标志）、程序（描述做什么）、数据（存放进程执行时所需数据）
进程基础的状态：就绪、运行、阻塞
前驱图：进程之间任务间的并行、任务间的先后顺序。
进程资源图：进程和资源之间的分配和请求关系。
P进程，R资源。圆圈——资源个数。资源—>进程：资源分配给了进程。进程—>资源：表示进程还需要某个资源。
阻塞节点：某进程所请求的资源已经被分配完了。没有资源分配给它。
非阻塞节点：某进程所请求的资源还有剩余。
当进程资源图所有进程都是阻塞节点，则死锁。
是否可以化简（最后能否顺利执行完）：先执行非阻塞节点（同时释放资源），执行其他节点。
进程同步与互斥
临界资源：各个进程以互斥的方式访问的资源。
临界区：对临界资源操作的那段程序。（代码）
互斥：同一时间内只能由一个任务单独使用，需要加锁。
同步：多个任务间可以并发执行。需要等待执行完。
信号量
互斥：对临界资源互斥访问，初值为1，同时只能一个使用。
同步：对共享资源访问的控制，初值事共享资源数量。
操作：
P(s)：申请资源，s=s-1。s>=0，则继续执行；s<0，则阻塞该进程，并加入阻塞队列。
V(s)：释放资源，s=s+1。s>0则继续执行；s<=0，则从阻塞队列中唤醒一个进程，并插入就绪队列。
前趋图和信号量流程图操作题：前驱图一条线代表一个信号量。左边箭头是后面执行需要申请的资源。
进程调度：当有更高优先级的进程到来时如何分配CPU。分为可剥夺和不可剥夺。
一个作业从提交到完成需要经历高、中、低三级调度。
高级调度/长调度/作业调度/接纳调度：决定处于输入池中哪个作业可以调入主系统做好运行的准备，成为一个或一组就绪进程。在系统中一个作业只需经过一次高级调度。
中级调度/中程调度/对换调度：处于交换区的哪个就绪进程可以掉入内存。
低级调度/短程调度/进程调度：处于内存中哪个就绪进程可以占用CPU。
进程调度算法：先来先服务，时间片轮转、优先级调度、多级反馈调度（时间片轮转+优先级调度结合。设置多个就绪队列，每个队列不同的优先级，不同的时间片长度）
死锁：
死锁概念：进程资源图所有节点都是阻塞节点。每个进程都在等待资源，资源又没有了。
死锁产生的四个必要条件。资源互斥（不可改变）、每个进程占有资源并等待其他资源（定时器可改变）、系统不能剥夺进程资源（操作系统强制剥夺）、进程资源图是一个环路。
打破四大条件：
死锁预防：破坏死锁产生的四大条件之一。定时器到时间释放资源，操作系统强制剥夺资源。
死锁避免：银行家算法，提前计算出一条不会死锁的资源分配方法，才分配资源，否则不分配资源。
死锁检测：定时检测死锁，检测到死锁，则死锁解除。
死锁解除：死锁发生后的解除方法，如强制剥夺资源，撤销进程等。
死锁资源计算：系统有n个进程，每个进程都需要R个资源，那么发生死锁的最大资源数为n*(R-1)，不发生死锁的最小资源数为n*(R-1)+1
线程：
传统进程：可拥有资源的独立单位；可独立调度和分配的基本单位。
引入线程的原因：进程在创建、撤销、切换的开销大。线程作为调度和分配的基本单位，进程作为独立分配资源的单位。线程间的资源是共享的。
线程是进程中的一个实体：线程控制块TCB、程序计数器PC、一组寄存器、栈。与同属于一个进程的其他线程共享进程所拥有的全部资源。线程私有，进程共有。
存储管理
分区：整存，将某进程运行所需的内存整体一起分配给它。三种分区方式。
固定分区：分片固定，会产生内部碎片。
可变分区：动态分区，不存在内部碎片，但容易整片主存空间切割成许多块，会产生外部碎片。假设当前内存分配好了。还需要分配9KB的空间，不同算法的结果有：
首次适应：按内存地址顺序从头查找，找到第一个>=9KB的空闲块，切割。
最佳适应：满足条件且最小的。
最差适应：满足条件且最大的。预防系统中产生过多的细小空闲块。
循环首次适应：按内存地址顺序查找，找到第一个>=9空闲块，如果还需分配，则找下一个，不需要从头查找。
可重定位分区：可以解决碎片问题，移动所有已经分配好的区域，变成一个连续的区域。这样外部小分区碎片合并成大分区。
分页（固定）：逻辑页分为页号和页内地址，页内地址就是物理偏移地址，页号与物理块号对应关系需查询页表。物理块号+偏移地址得出真正运行的物理地址。
优点：碎片小，利用率高，分配及管理简单。
缺点：增加系统开销，可能产生抖动现象。
页面置换算法：最优算法OPT（选择未来最长时间内不被访问的页面置换，理论上）、先进先出FIFO（抖动现象，页越多效率下降）、最近最少使用LRU（效率高，不会抖动）、淘汰原则（优先淘汰最近未访问的，而后淘汰最近未被修改的页面）
快表（快速的页表）：一块小容量的相联存储器，由快速存储器组成，按内容访问，速度快，访问最频繁的页号。快表是将页表存在Cache中；慢表是将页表存在内存上，慢表需要访问两次内存才能取出页，而快表是访问一次Cache和一次内存，因此更快。
题：页面大小为偏移量，4K=2^12位，二进制12位=十六进制3位。因此逻辑地址1D16H可得出D16为偏移量，1为页号。
分段（不固定）：将进程分为一个个段，每段也有段号和段内地址，每段的物理大小不同，分段是根据逻辑整体分段的。段表有段长和基址才能确认物理地址。
优点：多道程序共享内存。各段程序修改互不影响。
缺点：内存利用率低，内存碎片浪费大。
题目：逻辑地址（段号，偏移量），看看对应的偏移量是否在段长里。
段页式：对进程先分段后分页。
优点：空间浪费小，存储共享、保护容易，能动态链接。
缺点：复杂开销增加。执行速度下降。
设备管理
设备管理概述
I/O系统（负责管理设备和输入输出的机构）：设备、控制器、通道（具有通道的计算机系统）、总线和I/O软件组成。
设备的分类：
按数据组织分类：块、字符
按照设备功能分类：输入、输出、存储、网络联网、供电
资源分配角度分类：独占、共享、虚拟（虚设备，把独占设备转换成共享设备）
数据传输速率分类：低速、中速、高速
I/O软件：输入输出的设备管理软件。
分层：
用户进程：输入输出的调用
设备无关软件：命名、保护、阻塞、缓冲、分配；检查高速缓存中有无要读取的块。
设备驱动程序
中断处理程序
硬件
设备管理技术
虚设备：虚拟设备。通过设备管理SPOOLING技术，把独占设备变成共享设备。
SPOOLING技术（外围设备联机操作）技术：在外设上建立两个数据缓冲区，分为输入输出井。把请求进入缓冲区，按照顺序打印。每个进程都感觉在使用一个打印机，物理设备的虚拟化。
文件管理
文件管理概述
文件逻辑结构分为：有结构的记录式文件；无结构的流式文件。
文件物理结构式指文件在物理存储设备上的存放方法。
连续结构（顺序）：逻辑上连续的文件信息（如记录）依次放在连续编号的物理块上。
链接结构（串联）：存放在不连续的物理块上，每个物理块设有一个指针指向下一个物理块。
索引结构：系统为每个文件建立一张索引表。索引表记录了文件信息所在的逻辑块号对应的物理块号，并将索引表的起始地址放在与文件对应的文件目录项中。
多个物理块的索引表：索引表是在文件创建时由系统自动建立的，并与文件一起存放在同一文件卷上。根据一个文件大小的不同，其索引表占用物理块的个数不同，一般占一个或多个物理块。
索引文件结构（计算）
直接索引：每个索引等节点直接指向物理盘块。假设0-9为直接索引，每个物理盘块为4KB，则共可存4KB*10=40KB数据。
一级间接索引：直接指向的是直接索引。扩大了地址范围。假设10号为一级间接索引，大小为4KB，每个地址占4B，则共有4KB/4B=1024个地址，对应1024个物理盘，则可存1024*4KB=4096KB的数据。
二级索引：直接存放一级地址，一级地址存物理盘块地址。假设物理盘块大小4KB，索引地址占4B，则4KB/4B（二级地址） * 4KB/4B（一级地址） * 4KB（物理盘块大小） = 1024* 1024 * 4KB数据。
文件目录：
绝对路径（\开头然后\当前目录）
相对路径（不是\开头）不包含文件名
全文件名：绝对路径+文件名
文件存储空间管理
空闲区表（连续的文件结构）
位示图：每一位对应文件的物理块，0和1表示空闲和占用。1个磁盘块对应一个bit。字长xx，问需要多少字，磁盘块/字长=字。从0开始编号，513个是512块号。
空闲块链（不连续的）：
成组链接法：